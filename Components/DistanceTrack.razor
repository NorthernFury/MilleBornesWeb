@using MilleBornesWeb.Models

<div class="race-track-container">
    <div class="finish-line">🏁 FINISH</div>
    
    <div class="road">
        <div class="lane-divider"></div>
        
        <!-- Lane 1: Player (Left side) -->
        <div class="car-wrapper player-lane" style="@GetPositionStyle(PlayerDistance)">
            <div class="car-svg">
                <svg viewBox="0 0 50 100" xmlns="http://www.w3.org/2000/svg">
                    <rect x="10" y="20" width="30" height="60" rx="5" fill="currentColor" />
                    <rect x="15" y="45" width="20" height="15" rx="3" fill="#333" />
                    <rect x="5" y="75" width="40" height="8" fill="currentColor" />
                    <rect x="5" y="25" width="5" height="15" fill="#000" />
                    <rect x="40" y="25" width="5" height="15" fill="#000" />
                    <rect x="5" y="60" width="5" height="15" fill="#000" />
                    <rect x="40" y="60" width="5" height="15" fill="#000" />
                </svg>
            </div>
            <div class="car-label">YOU</div>
        </div>

        <!-- Lane 2: AI (Right side) -->
        <div class="car-wrapper ai-lane" style="@GetPositionStyle(AIDistance)">
            <div class="car-svg">
                <svg viewBox="0 0 50 100" xmlns="http://www.w3.org/2000/svg">
                    <rect x="10" y="20" width="30" height="60" rx="5" fill="currentColor" />
                    <rect x="15" y="45" width="20" height="15" rx="3" fill="#333" />
                    <rect x="5" y="75" width="40" height="8" fill="currentColor" />
                    <rect x="5" y="25" width="5" height="15" fill="#000" />
                    <rect x="40" y="25" width="5" height="15" fill="#000" />
                    <rect x="5" y="60" width="5" height="15" fill="#000" />
                    <rect x="40" y="60" width="5" height="15" fill="#000" />
                </svg>
            </div>
            <div class="car-label">AI</div>
        </div>
    </div>

    <div class="start-line">START</div>
</div>

@code {
    [Parameter] public int PlayerDistance { get; set; }
    [Parameter] public int AIDistance { get; set; }

    // Helper to generate the style string safely
    private string GetPositionStyle(int distance)
    {
        double pos = 0 + (distance / 1000.0) * 85;
        pos = Math.Min(pos, 92);
        return $"bottom: {pos}%;";
    }
}